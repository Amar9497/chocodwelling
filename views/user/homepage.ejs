<!-- Add custom animations -->
<style>
  @keyframes fade-in-down {
    0% {
      opacity: 0;
      transform: translateY(-20px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fade-in-up {
    0% {
      opacity: 0;
      transform: translateY(20px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in-down {
    animation: fade-in-down 1s ease-out;
  }

  .animate-fade-in-up {
    animation: fade-in-up 1s ease-out;
  }

  .animate-fade-in {
    animation: fade-in 1s ease-out;
  }
</style>
<!-- Best Sellers & New Launches sections follow similar enhanced patterns -->
<body class="bg-gray-50 text-gray-800">
  <!-- Navbar -->
  <%- include('navbar') %>

  <!-- alert -->
  <%- include('alert') %>
<!-- Hero Section with Animated Text -->
<section>
  <div class="relative h-[60vh] sm:h-[70vh] lg:h-[80vh] overflow-hidden">
    <div class="absolute inset-0">
        <img src="/public/assets/slid2.jpg" 
             alt="Hero Banner" 
             class="w-full h-full object-cover transform scale-100 group-hover:scale-105 transition-transform duration-700"
        />
        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/50 to-transparent">
            <div class="container mx-auto px-4 h-full flex flex-col justify-center items-center text-center">
                <h1 class="text-3xl sm:text-4xl md:text-6xl lg:text-7xl font-bold text-white mb-4 sm:mb-6 tracking-tight animate-fade-in-down">
                    Discover Premium <span class="text-[#8B7355]">Products</span>
                </h1>
                <p class="text-base sm:text-lg md:text-xl text-gray-200 mb-6 sm:mb-8 max-w-xl sm:max-w-2xl animate-fade-in-up leading-relaxed px-4">
                    Explore our curated collection of exclusive products and top brands
                </p>
                <a href="/allproduct" 
                   class="group inline-flex items-center gap-2 bg-white/90 backdrop-blur-sm text-gray-900 
                          px-8 py-4 rounded-full hover:bg-[#8B7355] hover:text-white 
                          transform hover:scale-105 transition-all duration-300">
                    Explore Collection
                    <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                    </svg>
                </a>
            </div>
        </div>
    </div>
  </div>
</section>

<section class="py-8 sm:py-12 lg:py-16 bg-white">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8">
      <!-- Feature Cards -->
      <div class="group p-4 sm:p-6 lg:p-8 bg-gray-50 rounded-xl sm:rounded-2xl hover:bg-[#8B7355] transition-colors duration-300">
        <div class="flex items-center gap-6">
          <div class="p-4 bg-white rounded-xl group-hover:bg-[#A79277] transition-colors">
            <svg class="w-8 h-8 text-[#8B7355] group-hover:text-white transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/>
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-semibold group-hover:text-white transition-colors">Free Shipping</h3>
            <p class="text-gray-600 group-hover:text-white/80 transition-colors">On orders over â‚¹500</p>
          </div>
        </div>
      </div>
      <div class="group p-4 sm:p-6 lg:p-8 bg-gray-50 rounded-xl sm:rounded-2xl hover:bg-[#8B7355] transition-colors duration-300">
        <div class="flex items-center gap-6">
          <div class="p-4 bg-white rounded-xl group-hover:bg-[#A79277] transition-colors">
            <svg class="w-8 h-8 text-[#8B7355] group-hover:text-white transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-semibold group-hover:text-white transition-colors">Secure Payment</h3>
            <p class="text-gray-600 group-hover:text-white/80 transition-colors">100% secure payment</p>
          </div>
        </div>
      </div>
      <div class="group p-4 sm:p-6 lg:p-8 bg-gray-50 rounded-xl sm:rounded-2xl hover:bg-[#8B7355] transition-colors duration-300">
        <div class="flex items-center gap-6">
          <div class="p-4 bg-white rounded-xl group-hover:bg-[#A79277] transition-colors">
            <svg class="w-8 h-8 text-[#8B7355] group-hover:text-white transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"/>
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-semibold group-hover:text-white transition-colors">24/7 Support</h3>
            <p class="text-gray-600 group-hover:text-white/80 transition-colors">Dedicated support</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

  

  <!-- Top Brands Section -->
  <section class="py-16 bg-gradient-to-b from-white to-gray-50">
    <div class="container mx-auto px-4">
      <!-- Title Section -->
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-4">Top Brands</h2>
        <p class="text-gray-600 max-w-xl mx-auto text-lg">
          Discover our collection of premium brands that define luxury and quality.
        </p>
      </div>
      <!-- Brand Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        <% brand.slice(0, 4).forEach((brand) => { %>
        <a href="/brand/<%= brand._id %>" class="group block">
          <div class="bg-white rounded-lg overflow-hidden shadow-lg hover:shadow-2xl transform hover:-translate-y-2 transition duration-300">
            <div class="relative">
              <img
                src="<%= brand.brandImage %>"
                alt="<%= brand.brandName %>"
                class="w-full h-56 object-cover"
              />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold text-center text-gray-800 group-hover:text-[#8B7355] transition-colors">
                <%= brand.brandName %>
              </h3>
              <div class="mt-4 flex justify-center">
                <span
                  class="text-sm text-[#8B7355] flex items-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                  Explore Products
                  <svg class="w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform duration-300"
                    fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M17 8l4 4m0 0l-4 4m4-4H3" />
                  </svg>
                </span>
              </div>
            </div>
          </div>
        </a>
        <% }) %>
      </div>
      <!-- View All Button -->
      <% if (brand.length > 4) { %>
      <div class="text-center mt-12">
        <a href="/category"
          class="inline-flex items-center px-8 py-3 bg-[#8B7355] text-white text-lg font-medium rounded-full 
          hover:bg-[#A79277] transform hover:scale-105 transition-all duration-300">
          View All Brands
          <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
      <% } %>
    </div>
  </section>
  

  <!-- Best Sellers Section -->
  <section class="py-8 sm:py-12 lg:py-16 bg-white">
    <div class="container mx-auto px-4">
      <div class="text-center mb-8 sm:mb-12">
        <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-800 mb-2 sm:mb-4">Best Sellers</h2>
        <p class="text-gray-600 max-w-2xl mx-auto text-sm sm:text-base">Our most popular products</p>
      </div>
      
      <!-- Product Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6 lg:gap-8">
        <% product.slice(0, 4).forEach((product) => { %>
        <div class="group relative">
          <div class="bg-white rounded-xl sm:rounded-2xl overflow-hidden shadow-sm hover:shadow-xl transform hover:scale-105 transition duration-300">
            <!-- Product Image -->
            <div class="relative aspect-square overflow-hidden">
              <a href="/productDetail/<%= product._id %>">
              <img src="<%= product.productImage[0] %>"
                   alt="<%= product.productName %>"
                   class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
              />
            </a>
              <!-- Wishlist Button -->
              <button onclick="addToWishlist('<%= product._id %>')"
                      class="absolute top-3 right-3 sm:top-4 sm:right-4 z-10 p-1.5 sm:p-2 rounded-full bg-white/90 backdrop-blur-sm 
                             opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                <svg class="w-5 h-5 text-gray-600 hover:text-red-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
              </button>
            </div>

            <!-- Product Info -->
            <div class="p-3 sm:p-4 lg:p-5">
              <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-1 sm:mb-2 line-clamp-1">
                <%= product.productName %>
              </h3>

              <!-- Ratings -->
              <div class="flex items-center gap-1 sm:gap-1.5 mb-2">
                <div class="flex">
                  <% for(let i = 1; i <= 5; i++) { %>
                    <% if (i <= Math.round(product.ratings.average)) { %>
                      <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                      </svg>
                    <% } else { %>
                      <svg class="w-4 h-4 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                      </svg>
                    <% } %>
                  <% } %>
                </div>
                <span class="text-sm text-gray-500">
                  (<%= product.ratings.total %> reviews)
                </span>
              </div>

              <!-- Price and Discount -->
              <div class="flex flex-wrap items-baseline gap-1 sm:gap-2 mb-3 sm:mb-4">
                <span class="text-xl sm:text-2xl font-bold text-[#8B7355]">
                  â‚¹<%= Math.round(product.productVariants[0].price * (1 - product.productDiscount/100)) %>
                </span>
                <% if (product.productDiscount > 0) { %>
                  <span class="text-xs sm:text-sm text-gray-500 line-through">
                    â‚¹<%= product.productVariants[0].price %>
                  </span>
                  <span class="text-xs sm:text-sm font-medium text-green-600">
                    <%= product.productDiscount %>% off
                  </span>
                <% } %>
              </div>

              <!-- Add to Cart Button -->
              <button onclick="addToCart('<%= product._id %>')"
                      class="w-full py-2 sm:py-2.5 text-sm sm:text-base bg-[#8B7355] text-white rounded-lg 
                             hover:bg-[#A79277] transition-colors duration-300 focus:outline-none 
                             focus:ring-2 focus:ring-[#8B7355] focus:ring-offset-2">
                Add to Cart
              </button>
            </div>
          </div>
        </div>
        <% }) %>
      </div>
      <% if (product.length > 4) { %>
      <div class="text-center mt-12">
        <a href="/allProduct" 
           class="inline-flex items-center px-8 py-3 bg-[#8B7355] text-white rounded-full 
           hover:bg-[#A79277] transform hover:scale-105 transition-all duration-300">
          View All Products
          <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
      <% } %>
    </div>
  </section>

  <!-- New Launches Section -->
  <section class="py-16 bg-gradient-to-b from-gray-50 to-white">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <span class="text-[#8B7355] font-semibold text-sm tracking-wider uppercase">Latest Additions</span>
        <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mt-2 mb-4">New Launches</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">Be the first to try our newest products</p>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
        <% newLaunches.slice(0, 4).forEach((product) => { %>
        <div class="group relative">
          <div class="bg-white rounded-2xl overflow-hidden shadow-md hover:shadow-xl transform hover:scale-105 transition duration-300">
            <!-- Product Image -->
             
            <div class="relative aspect-square overflow-hidden">
              <a href="/productDetail/<%= product._id %>">
              <img
                src="<%= product.productImage[0] %>"
                alt="<%= product.productName %>"
                class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
              />
            </a>
              <!-- New Label -->
              <div class="absolute top-4 left-4">
                <span class="bg-red-500 text-white text-xs px-3 py-1 rounded-full uppercase tracking-wide">
                  New
                </span>
              </div>
              <!-- Wishlist Button -->
              <button
                onclick="addToWishlist('<%= product._id %>')"
                class="absolute top-4 right-4 z-10 p-2 rounded-full bg-white/90 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300"
              >
                <svg class="w-5 h-5 text-gray-600 hover:text-red-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
              </button>
            </div>

            <!-- Product Info -->
            <div class="p-5">
              <h3 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-1">
                <%= product.productName %>
              </h3>

              <!-- Ratings -->
              <div class="flex items-center gap-1.5 mb-2">
                <div class="flex">
                  <% for(let i = 1; i <= 5; i++) { %>
                    <% if (i <= Math.round(product.ratings.average)) { %>
                      <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                      </svg>
                    <% } else { %>
                      <svg class="w-4 h-4 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                      </svg>
                    <% } %>
                  <% } %>
                </div>
                <span class="text-sm text-gray-500">
                  (<%= product.ratings.total %> reviews)
                </span>
              </div>

              <!-- Price and Discount -->
              <div class="flex items-baseline gap-2 mb-4">
                <span class="text-2xl font-bold text-[#8B7355]">
                  â‚¹<%= Math.round(product.productVariants[0].price * (1 - product.productDiscount/100)) %>
                </span>
                <% if (product.productDiscount > 0) { %>
                  <span class="text-sm text-gray-500 line-through">
                    â‚¹<%= product.productVariants[0].price %>
                  </span>
                  <span class="text-sm font-medium text-green-600">
                    <%= product.productDiscount %>% off
                  </span>
                <% } %>
              </div>

              <!-- Add to Cart Button -->
              <button
                onclick="addToCart('<%= product._id %>')"
                class="w-full py-2.5 bg-[#8B7355] text-white rounded-lg hover:bg-[#A79277] transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-[#8B7355] focus:ring-offset-2"
              >
                Add to Cart
              </button>
            </div>
          </div>
        </div>
        <% }) %>
      </div>
    </div>
  </section>

  

  <!-- Footer -->
  <%- include('footer') %>

  
</body>

<script>

  
// add wishlist

async function addToWishlist(productId) {
    try {
        const response = await fetch(`/add-wishlist/${productId}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        });

        const data = await response.json();

        if (!response.ok) {
            // Handle unauthorized (not logged in) case
            if (response.status === 401) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Please Login',
                    text: 'You need to login to add items to wishlist',
                    showCancelButton: true,
                    confirmButtonText: 'Login',
                    confirmButtonColor: '#8B7355',
                    cancelButtonColor: '#d33',
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = '/login';
                    }
                });
                return;
            }
            
            // Handle already in wishlist case
            if (response.status === 400) {
                Swal.fire({
                    icon: 'info',
                    title: 'Already in Wishlist',
                    text: 'This item is already in your wishlist',
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    customClass: {
                        popup: 'colored-toast'
                    }
                });
                return;
            }

            throw new Error(data.message || 'Failed to add to wishlist');
        }

        // Success case
        const wishlistIcon = document.getElementById(`wishlist-icon-${productId}`);
        if (wishlistIcon) {
            wishlistIcon.setAttribute('fill', 'red');
        }

        Swal.fire({
            icon: 'success',
            title: 'Added to Wishlist!',
            text: 'Item successfully added to your wishlist',
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            customClass: {
                popup: 'colored-toast'
            }
        });

    } catch (error) {
        console.error('Error adding to wishlist:', error);
        Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: error.message || 'Something went wrong!',
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            customClass: {
                popup: 'colored-toast'
            }
        });
    }
}

// add to cart


async function addToCart(productId) {
    try {
        const response = await fetch("/addToCart", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                productId: productId,
                quantity: 1, // Default to 1 for direct add-to-cart from listing
            }),
        });

        const data = await response.json();

        if (!response.ok) {
            // Handle unauthorized (not logged in) case
            if (response.status === 401) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Please Login',
                    text: 'You need to login to add items to cart',
                    showCancelButton: true,
                    confirmButtonText: 'Login',
                    confirmButtonColor: '#8B7355',
                    cancelButtonColor: '#d33',
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = '/login';
                    }
                });
                return;
            }
            
            throw new Error(data.message || 'Failed to add to cart');
        }

        // Success case
        Swal.fire({
            icon: 'success',
            title: 'Added to Cart!',
            text: data.message || 'Item successfully added to your cart',
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            customClass: {
                popup: 'colored-toast'
            }
        });

        // Update cart count if it exists
        const cartCountElement = document.getElementById("cart-count");
        if (cartCountElement) {
            const currentCount = parseInt(cartCountElement.textContent || '0');
            cartCountElement.textContent = currentCount + 1;
        }

    } catch (error) {
        console.error('Error adding to cart:', error);
        Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: error.message || 'Something went wrong!',
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            customClass: {
                popup: 'colored-toast'
            }
        });
    }
}

</script>
